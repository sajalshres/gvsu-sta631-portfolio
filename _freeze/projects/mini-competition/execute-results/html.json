{
  "hash": "16da3eb7a4d68801b70bd0ee60f2f566",
  "result": {
    "markdown": "---\ntitle: \"Mini Competition - Allendale Students\"\nformat: \n  html:\n    code-fold: false\n    code-summary: \"Show the code\"\n    code-line-numbers: true\n---\n\n::: {.cell}\n\n:::\n\n\n## Introduction\n\n## Import Data\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nallendale_students <- readr::read_csv(\"../data/allendale-students.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(allendale_students) %>%\n  knitr::kable()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> distance </th>\n   <th style=\"text-align:right;\"> scholarship </th>\n   <th style=\"text-align:right;\"> parents </th>\n   <th style=\"text-align:right;\"> car </th>\n   <th style=\"text-align:left;\"> housing </th>\n   <th style=\"text-align:left;\"> major </th>\n   <th style=\"text-align:right;\"> debt </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 40 </td>\n   <td style=\"text-align:right;\"> 1532 </td>\n   <td style=\"text-align:right;\"> 0.440 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:left;\"> off campus </td>\n   <td style=\"text-align:left;\"> STEM </td>\n   <td style=\"text-align:right;\"> 26389 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 7479 </td>\n   <td style=\"text-align:right;\"> 0.265 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:left;\"> on campus </td>\n   <td style=\"text-align:left;\"> STEM </td>\n   <td style=\"text-align:right;\"> 21268 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 130 </td>\n   <td style=\"text-align:right;\"> 2664 </td>\n   <td style=\"text-align:right;\"> 0.115 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;\"> on campus </td>\n   <td style=\"text-align:left;\"> business </td>\n   <td style=\"text-align:right;\"> 32312 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 120 </td>\n   <td style=\"text-align:right;\"> 1998 </td>\n   <td style=\"text-align:right;\"> 0.325 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:left;\"> on campus </td>\n   <td style=\"text-align:left;\"> business </td>\n   <td style=\"text-align:right;\"> 28539 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 1462 </td>\n   <td style=\"text-align:right;\"> 0.105 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:left;\"> off campus </td>\n   <td style=\"text-align:left;\"> other </td>\n   <td style=\"text-align:right;\"> 34867 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3053 </td>\n   <td style=\"text-align:right;\"> 0.335 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:left;\"> off campus </td>\n   <td style=\"text-align:left;\"> STEM </td>\n   <td style=\"text-align:right;\"> 18193 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(allendale_students) %>% kable()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:left;\">    distance </th>\n   <th style=\"text-align:left;\">  scholarship </th>\n   <th style=\"text-align:left;\">    parents </th>\n   <th style=\"text-align:left;\">      car </th>\n   <th style=\"text-align:left;\">   housing </th>\n   <th style=\"text-align:left;\">    major </th>\n   <th style=\"text-align:left;\">      debt </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> Min.   :  0.00 </td>\n   <td style=\"text-align:left;\"> Min.   :   25 </td>\n   <td style=\"text-align:left;\"> Min.   :0.0000 </td>\n   <td style=\"text-align:left;\"> Min.   : 1.00 </td>\n   <td style=\"text-align:left;\"> Length:200 </td>\n   <td style=\"text-align:left;\"> Length:200 </td>\n   <td style=\"text-align:left;\"> Min.   : 2019 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> 1st Qu.: 30.00 </td>\n   <td style=\"text-align:left;\"> 1st Qu.: 1312 </td>\n   <td style=\"text-align:left;\"> 1st Qu.:0.1588 </td>\n   <td style=\"text-align:left;\"> 1st Qu.: 6.00 </td>\n   <td style=\"text-align:left;\"> Class :character </td>\n   <td style=\"text-align:left;\"> Class :character </td>\n   <td style=\"text-align:left;\"> 1st Qu.:24231 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> Median : 70.00 </td>\n   <td style=\"text-align:left;\"> Median : 3202 </td>\n   <td style=\"text-align:left;\"> Median :0.2800 </td>\n   <td style=\"text-align:left;\"> Median : 7.00 </td>\n   <td style=\"text-align:left;\"> Mode  :character </td>\n   <td style=\"text-align:left;\"> Mode  :character </td>\n   <td style=\"text-align:left;\"> Median :29827 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> Mean   : 96.55 </td>\n   <td style=\"text-align:left;\"> Mean   : 3899 </td>\n   <td style=\"text-align:left;\"> Mean   :0.2666 </td>\n   <td style=\"text-align:left;\"> Mean   : 7.08 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> Mean   :29473 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> 3rd Qu.:140.00 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.: 5504 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.:0.3812 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.: 9.00 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> 3rd Qu.:35022 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> Max.   :530.00 </td>\n   <td style=\"text-align:left;\"> Max.   :26574 </td>\n   <td style=\"text-align:left;\"> Max.   :0.4950 </td>\n   <td style=\"text-align:left;\"> Max.   :12.00 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> Max.   :49196 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npsych::pairs.panels(\n  allendale_students,\n  hist.col = \"#00AFBB\",\n  method= \"pearson\",\n  density = TRUE,\n  ellipses = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](mini-competition_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nFrom the above visualization, we can observe that the observations in distance and scholarship variables are skewed towards right. Also, we can observe that the variable debt has some correlation with distance, scholarship and parents variables.\n\n## Single Linear Regression\n\n\n\n```{.r .cell-code}\nfor (x in c(\"distance\", \"scholarship\", \"parents\", \"car\", \"housing\")) {\n  m <- lm(paste(\"debt\", \"~\", x), data = allendale_students)\n  print(tidy(m) %>% kable(caption = paste(\"formula: debt\", \"~\", x)))\n\n}\n```\n\n<table>\n<caption>formula: debt ~ distance</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 24910.73423 </td>\n   <td style=\"text-align:right;\"> 768.492674 </td>\n   <td style=\"text-align:right;\"> 32.415058 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> distance </td>\n   <td style=\"text-align:right;\"> 47.25003 </td>\n   <td style=\"text-align:right;\"> 5.845699 </td>\n   <td style=\"text-align:right;\"> 8.082871 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n<table>\n<caption>formula: debt ~ scholarship</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 35735.773269 </td>\n   <td style=\"text-align:right;\"> 702.3780382 </td>\n   <td style=\"text-align:right;\"> 50.87826 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> scholarship </td>\n   <td style=\"text-align:right;\"> -1.606293 </td>\n   <td style=\"text-align:right;\"> 0.1359803 </td>\n   <td style=\"text-align:right;\"> -11.81268 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n<table>\n<caption>formula: debt ~ parents</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 35587.43 </td>\n   <td style=\"text-align:right;\"> 1208.988 </td>\n   <td style=\"text-align:right;\"> 29.435710 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> parents </td>\n   <td style=\"text-align:right;\"> -22931.59 </td>\n   <td style=\"text-align:right;\"> 4023.178 </td>\n   <td style=\"text-align:right;\"> -5.699869 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n<table>\n<caption>formula: debt ~ car</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 29553.70566 </td>\n   <td style=\"text-align:right;\"> 2191.521 </td>\n   <td style=\"text-align:right;\"> 13.4854760 </td>\n   <td style=\"text-align:right;\"> 0.0000000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> car </td>\n   <td style=\"text-align:right;\"> -11.43795 </td>\n   <td style=\"text-align:right;\"> 297.650 </td>\n   <td style=\"text-align:right;\"> -0.0384275 </td>\n   <td style=\"text-align:right;\"> 0.9693856 </td>\n  </tr>\n</tbody>\n</table>\n<table>\n<caption>formula: debt ~ housing</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 28789.608 </td>\n   <td style=\"text-align:right;\"> 772.7184 </td>\n   <td style=\"text-align:right;\"> 37.257566 </td>\n   <td style=\"text-align:right;\"> 0.0000000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> housingon campus </td>\n   <td style=\"text-align:right;\"> 1707.792 </td>\n   <td style=\"text-align:right;\"> 1221.7751 </td>\n   <td style=\"text-align:right;\"> 1.397795 </td>\n   <td style=\"text-align:right;\"> 0.1637385 </td>\n  </tr>\n</tbody>\n</table>\n\n\n## Multiple Linear Regression\n\nFit the multiple linear regression with debt as dependent variables and distance, scholarship and parents as independent variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm_mlr_dsp <- lm(debt ~ distance + scholarship + parents , data = allendale_students)\ntidy(m_mlr_dsp) %>% kable()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 37510.151327 </td>\n   <td style=\"text-align:right;\"> 852.1851796 </td>\n   <td style=\"text-align:right;\"> 44.01643 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> distance </td>\n   <td style=\"text-align:right;\"> 40.480992 </td>\n   <td style=\"text-align:right;\"> 3.4285774 </td>\n   <td style=\"text-align:right;\"> 11.80694 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> scholarship </td>\n   <td style=\"text-align:right;\"> -1.544496 </td>\n   <td style=\"text-align:right;\"> 0.0901445 </td>\n   <td style=\"text-align:right;\"> -17.13356 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> parents </td>\n   <td style=\"text-align:right;\"> -22215.518409 </td>\n   <td style=\"text-align:right;\"> 2201.4066083 </td>\n   <td style=\"text-align:right;\"> -10.09151 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nAccess model fit using `glance`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglance(m_mlr_dsp) %>% kable()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> r.squared </th>\n   <th style=\"text-align:right;\"> adj.r.squared </th>\n   <th style=\"text-align:right;\"> sigma </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> df </th>\n   <th style=\"text-align:right;\"> logLik </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n   <th style=\"text-align:right;\"> deviance </th>\n   <th style=\"text-align:right;\"> df.residual </th>\n   <th style=\"text-align:right;\"> nobs </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.7466082 </td>\n   <td style=\"text-align:right;\"> 0.7427297 </td>\n   <td style=\"text-align:right;\"> 4303.73 </td>\n   <td style=\"text-align:right;\"> 192.5019 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> -1955.215 </td>\n   <td style=\"text-align:right;\"> 3920.43 </td>\n   <td style=\"text-align:right;\"> 3936.921 </td>\n   <td style=\"text-align:right;\"> 3630330014 </td>\n   <td style=\"text-align:right;\"> 196 </td>\n   <td style=\"text-align:right;\"> 200 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nNow, lets access the model diagnostics using the `ggplot2::autoplot` function.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot2::autoplot(m_mlr_dsp)\n```\n\n::: {.cell-output-display}\n![](mini-competition_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=960}\n:::\n:::\n\n\nIn the above diagnostics plot, we can observe that observation 11 is clearly an outlier. Lets use `broom::augment` to further analyze the outlier.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# https://broom.tidymodels.org/reference/augment.lm.html\naugment_allendale_students <- broom::augment(m_mlr_dsp, data=allendale_students)\n```\n:::\n\n\nLooking into `augment_allendale_students` variable, it looks like observation `11` is clearly an outlier. lets remove it from the data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- allendale_students %>%\n  filter(!row_number() %in% c(11))\n```\n:::\n\n\nNow, lets fit the multiple linear regression again:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm_mlr_dsp <- lm(debt ~ distance + scholarship + parents , data = data)\ntidy(m_mlr_dsp) %>% kable()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 38830.301126 </td>\n   <td style=\"text-align:right;\"> 782.338344 </td>\n   <td style=\"text-align:right;\"> 49.63364 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> distance </td>\n   <td style=\"text-align:right;\"> 40.568226 </td>\n   <td style=\"text-align:right;\"> 3.058887 </td>\n   <td style=\"text-align:right;\"> 13.26241 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> scholarship </td>\n   <td style=\"text-align:right;\"> -1.855369 </td>\n   <td style=\"text-align:right;\"> 0.091400 </td>\n   <td style=\"text-align:right;\"> -20.29944 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> parents </td>\n   <td style=\"text-align:right;\"> -23240.799262 </td>\n   <td style=\"text-align:right;\"> 1969.237414 </td>\n   <td style=\"text-align:right;\"> -11.80193 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglance(m_mlr_dsp) %>% kable()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> r.squared </th>\n   <th style=\"text-align:right;\"> adj.r.squared </th>\n   <th style=\"text-align:right;\"> sigma </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> df </th>\n   <th style=\"text-align:right;\"> logLik </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n   <th style=\"text-align:right;\"> deviance </th>\n   <th style=\"text-align:right;\"> df.residual </th>\n   <th style=\"text-align:right;\"> nobs </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.7958825 </td>\n   <td style=\"text-align:right;\"> 0.7927422 </td>\n   <td style=\"text-align:right;\"> 3839.645 </td>\n   <td style=\"text-align:right;\"> 253.444 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> -1922.722 </td>\n   <td style=\"text-align:right;\"> 3855.445 </td>\n   <td style=\"text-align:right;\"> 3871.911 </td>\n   <td style=\"text-align:right;\"> 2874860401 </td>\n   <td style=\"text-align:right;\"> 195 </td>\n   <td style=\"text-align:right;\"> 199 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nWe can observed imporved model after removing the outlier. Now lets try to fit the MLR with different interation:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm_mlr_1 <- lm(debt ~ distance * car + scholarship + parents, data = data)\nglance(m_mlr_1) %>% kable()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> r.squared </th>\n   <th style=\"text-align:right;\"> adj.r.squared </th>\n   <th style=\"text-align:right;\"> sigma </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> df </th>\n   <th style=\"text-align:right;\"> logLik </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n   <th style=\"text-align:right;\"> deviance </th>\n   <th style=\"text-align:right;\"> df.residual </th>\n   <th style=\"text-align:right;\"> nobs </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.7979778 </td>\n   <td style=\"text-align:right;\"> 0.7927441 </td>\n   <td style=\"text-align:right;\"> 3839.628 </td>\n   <td style=\"text-align:right;\"> 152.4681 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> -1921.696 </td>\n   <td style=\"text-align:right;\"> 3857.391 </td>\n   <td style=\"text-align:right;\"> 3880.444 </td>\n   <td style=\"text-align:right;\"> 2845349351 </td>\n   <td style=\"text-align:right;\"> 193 </td>\n   <td style=\"text-align:right;\"> 199 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm_mlr_2 <- lm(debt ~ distance * scholarship * parents * housing, data = data)\nglance(m_mlr_2) %>% kable()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> r.squared </th>\n   <th style=\"text-align:right;\"> adj.r.squared </th>\n   <th style=\"text-align:right;\"> sigma </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> df </th>\n   <th style=\"text-align:right;\"> logLik </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n   <th style=\"text-align:right;\"> deviance </th>\n   <th style=\"text-align:right;\"> df.residual </th>\n   <th style=\"text-align:right;\"> nobs </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.8075695 </td>\n   <td style=\"text-align:right;\"> 0.7917965 </td>\n   <td style=\"text-align:right;\"> 3848.395 </td>\n   <td style=\"text-align:right;\"> 51.19952 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> -1916.856 </td>\n   <td style=\"text-align:right;\"> 3867.711 </td>\n   <td style=\"text-align:right;\"> 3923.698 </td>\n   <td style=\"text-align:right;\"> 2710256253 </td>\n   <td style=\"text-align:right;\"> 183 </td>\n   <td style=\"text-align:right;\"> 199 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata = data %>%\n  mutate(sqrt_scholarship = sqrt(scholarship))\n\n\nm_mlr_3 <- lm(debt ~ distance * scholarship * parents * major, data = data)\ntidy(m_mlr_3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 24 × 5\n   term                      estimate  std.error statistic  p.value\n   <chr>                        <dbl>      <dbl>     <dbl>    <dbl>\n 1 (Intercept)           41158.       3441.        12.0    1.77e-24\n 2 distance                 12.3        30.7        0.400  6.89e- 1\n 3 scholarship              -1.34        0.689     -1.94   5.37e- 2\n 4 parents              -29299.       9964.        -2.94   3.72e- 3\n 5 majorother             3153.       4380.         0.720  4.72e- 1\n 6 majorSTEM             -6521.       4180.        -1.56   1.21e- 1\n 7 distance:scholarship     -0.000311    0.00615   -0.0505 9.60e- 1\n 8 distance:parents        108.         93.6        1.16   2.49e- 1\n 9 scholarship:parents      -0.978       1.91      -0.512  6.10e- 1\n10 distance:majorother      -9.08       41.0       -0.222  8.25e- 1\n# ℹ 14 more rows\n```\n:::\n\n```{.r .cell-code}\nglance(m_mlr_3) %>% kable()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> r.squared </th>\n   <th style=\"text-align:right;\"> adj.r.squared </th>\n   <th style=\"text-align:right;\"> sigma </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> df </th>\n   <th style=\"text-align:right;\"> logLik </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n   <th style=\"text-align:right;\"> deviance </th>\n   <th style=\"text-align:right;\"> df.residual </th>\n   <th style=\"text-align:right;\"> nobs </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.8351244 </td>\n   <td style=\"text-align:right;\"> 0.8134551 </td>\n   <td style=\"text-align:right;\"> 3642.733 </td>\n   <td style=\"text-align:right;\"> 38.53941 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 23 </td>\n   <td style=\"text-align:right;\"> -1901.479 </td>\n   <td style=\"text-align:right;\"> 3852.957 </td>\n   <td style=\"text-align:right;\"> 3935.29 </td>\n   <td style=\"text-align:right;\"> 2322163528 </td>\n   <td style=\"text-align:right;\"> 175 </td>\n   <td style=\"text-align:right;\"> 199 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThe model `m_mlr_3` seems to be the best fit.\n\nNext, let investigate if performing normalization can boost our model:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnorm_data <- data %>%\n  mutate(log_distance = log(distance)) %>%\n  mutate(log_scholarship = log(scholarship))\n\n# Remove inf values\nnorm_data$log_distance[is.infinite(norm_data$log_distance)] <- 0\nnorm_data$log_scholarship[is.infinite(norm_data$log_scholarship)] <- 0\n\n# fit model\nm_mlr_4 <- lm(debt ~ log_distance + scholarship + parents, data = norm_data)\nglance(m_mlr_4) %>% kable()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> r.squared </th>\n   <th style=\"text-align:right;\"> adj.r.squared </th>\n   <th style=\"text-align:right;\"> sigma </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> df </th>\n   <th style=\"text-align:right;\"> logLik </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n   <th style=\"text-align:right;\"> deviance </th>\n   <th style=\"text-align:right;\"> df.residual </th>\n   <th style=\"text-align:right;\"> nobs </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.7410626 </td>\n   <td style=\"text-align:right;\"> 0.7370789 </td>\n   <td style=\"text-align:right;\"> 4324.624 </td>\n   <td style=\"text-align:right;\"> 186.0259 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> -1946.392 </td>\n   <td style=\"text-align:right;\"> 3902.785 </td>\n   <td style=\"text-align:right;\"> 3919.251 </td>\n   <td style=\"text-align:right;\"> 3646963035 </td>\n   <td style=\"text-align:right;\"> 195 </td>\n   <td style=\"text-align:right;\"> 199 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nNo improvements, The model `m_mlr_3` produces better result.\n\nNow lets perform some model diagnostics for model `m_mlr_3`:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot2::autoplot(m_mlr_3)\n```\n\n::: {.cell-output-display}\n![](mini-competition_files/figure-html/unnamed-chunk-14-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n## Test for Collinearity\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncar::vif(m_mlr_3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                         GVIF Df GVIF^(1/(2*Df))\ndistance                            113.11203  1       10.635414\nscholarship                          63.58333  1        7.973915\nparents                              28.65536  1        5.353070\nmajor                              1268.42470  2        5.967826\ndistance:scholarship                118.32967  1       10.877944\ndistance:parents                    111.65165  1       10.566535\nscholarship:parents                  56.88293  1        7.542078\ndistance:major                     5347.65939  2        8.551473\nscholarship:major                  3212.95258  2        7.528806\nparents:major                      1515.36329  2        6.239204\ndistance:scholarship:parents        107.05318  1       10.346651\ndistance:scholarship:major         7127.67600  2        9.188339\ndistance:parents:major             4777.19820  2        8.313680\nscholarship:parents:major          2049.26537  2        6.728210\ndistance:scholarship:parents:major 5242.04749  2        8.508936\n```\n:::\n:::\n",
    "supporting": [
      "mini-competition_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}